var pokemonRepository = (function() {
	var t = [],
		e = $('.pokemon-list');
	function o(e) {
		t.push(e);
	}
	function n(t) {
		var e = $('.modal-body');
		$('#pokemon-name').text(t.name),
			e.html(
				'Height: ' +
					t.height / 10 +
					' meters<br/><br/>Weight: ' +
					(0.22 * t.weight).toFixed(2) +
					' pounds<br/><br/>Type(s): <span class="pokemon-types">' +
					t.types +
					'</span>'
			),
			$('.modal-header').addClass(t.types),
			$('.close').click(() => {
				$('.modal-header').removeClass(t.types);
			});
		var o = $('<img class="pokemon-picture"/>');
		o.attr('src', t.imageUrl), e.append(o);
	}
	return (
		$('#modal-container'),
		{
			add: o,
			getAll: function() {
				return t;
			},
			addListItem: function(t) {
				var o = $('<li></li>');
				e.append(o);
				var a = $(
					'<button class="btn pokemon-name pokemonSelectorButton" data-toggle="modal" data-target="#modal-container">' +
						t.name +
						'</button>'
				);
				o.append(a),
					a.click(function() {
						!(function(t) {
							pokemonRepository
								.loadDetails(t)
								.then(function() {
									return t;
								})
								.then(function(t) {
									n(t);
								})
								.catch(function(t) {
									console.error(t);
								});
						})(t);
					});
			},
			showModal: n,
			loadList: function() {
				return $.ajax('https://pokeapi.co/api/v2/pokemon/?limit=150', {
					dataType: 'json',
					success: function(t) {
						t.results.forEach(function(t) {
							o({ name: t.name, detailsUrl: t.url });
						});
					}
				}).fail(function(t) {
					console.error(t);
				});
			},
			loadDetails: function(t) {
				var e = t.detailsUrl;
				return $.ajax(e, { dataType: 'json' })
					.then(function(t) {
						return t;
					})
					.then(function(e) {
						(t.imageUrl = e.sprites.front_default),
							(t.height = e.height),
							(t.weight = e.weight),
							(t.types = e.types.map(function(t) {
								return t.type.name;
							}));
					})
					.catch(function(t) {
						console.error(t);
					});
			},
			searchBar: searchBar
		}
	);
})();
pokemonRepository.loadList().then(function() {
	pokemonRepository.getAll().forEach(function(t) {
		pokemonRepository.addListItem(t);
	});
}),
	$('#searchBar').on('keyup', function() {
		var t = $(this).val().toLowerCase();
		$('.pokemon-name').filter(function() {
			$(this).toggle($(this).text().toLowerCase().indexOf(t) > -1);
		});
	});
